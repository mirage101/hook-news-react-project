{"ast":null,"code":"import _toConsumableArray from \"D:\\\\React\\\\PROEKTI\\\\hook_news\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nvar _jsxFileName = \"D:\\\\React\\\\PROEKTI\\\\hook_news\\\\src\\\\components\\\\Link\\\\LinkItem.js\";\nimport React from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { getDomain } from \"../../utils\";\nimport distanceInWordsToNow from \"date-fns/distance_in_words_to_now\";\nimport FirebaseContext from \"../../firebase/context\";\n\nfunction LinkItem(_ref) {\n  var link = _ref.link,\n      index = _ref.index,\n      showCount = _ref.showCount,\n      history = _ref.history;\n\n  var _React$useContext = React.useContext(FirebaseContext),\n      firebase = _React$useContext.firebase,\n      user = _React$useContext.user;\n\n  function handleVote() {\n    if (!user) {\n      history.push(\"/login\");\n    } else {\n      var voteRef = firebase.db.collection(\"links\").doc(link.id);\n      voteRef.get().then(function (doc) {\n        if (doc.exists) {\n          var previousVotes = doc.data().votes;\n          var vote = {\n            votedBy: {\n              id: user.uid,\n              name: user.displayName\n            }\n          };\n          var updatedVotes = [].concat(_toConsumableArray(previousVotes), [vote]);\n          var voteCount = updatedVotes.length;\n          voteRef.update({\n            votes: updatedVotes,\n            voteCount: voteCount\n          });\n        }\n      });\n    }\n  }\n\n  function handleDeleteLink() {\n    var linkRef = firebase.db.collection(\"links\").doc(link.id);\n    linkRef.delete().then(function () {\n      console.log(\"Document with ID \".concat(link.id, \" deleted\"));\n    }).catch(function (err) {\n      console.error(\"Error deleting document:\", err);\n    });\n  }\n\n  var postedByAuthUser = user && user.uid === link.postedBy.id;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex items-start mt2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }\n  }, showCount && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"gray\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 23\n    }\n  }, index, \".\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vote-button\",\n    onClick: handleVote,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 9\n    }\n  }, \"\\u25B2\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ml1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: link.url,\n    className: \"black no-underline\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 11\n    }\n  }, link.description), \" \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"link\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 11\n    }\n  }, \"(\", getDomain(link.url), \")\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"f6 lh-copy gray\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }\n  }, link.voteCount, \" votes by \", link.postedBy.name, \" \", distanceInWordsToNow(link.created), \" | \", /*#__PURE__*/React.createElement(Link, {\n    to: \"/link/\".concat(link.id),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 11\n    }\n  }, link.comments.length > 0 ? \"\".concat(link.comments.length, \" comments\") : \"discuss\"), postedByAuthUser && /*#__PURE__*/React.createElement(React.Fragment, null, \" | \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"delete-button\",\n    onClick: handleDeleteLink,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 15\n    }\n  }, \"delete\")))));\n}\n\nexport default withRouter(LinkItem);","map":{"version":3,"sources":["D:/React/PROEKTI/hook_news/src/components/Link/LinkItem.js"],"names":["React","Link","withRouter","getDomain","distanceInWordsToNow","FirebaseContext","LinkItem","link","index","showCount","history","useContext","firebase","user","handleVote","push","voteRef","db","collection","doc","id","get","then","exists","previousVotes","data","votes","vote","votedBy","uid","name","displayName","updatedVotes","voteCount","length","update","handleDeleteLink","linkRef","delete","console","log","catch","err","error","postedByAuthUser","postedBy","url","description","created","comments"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { getDomain } from \"../../utils\";\nimport distanceInWordsToNow from \"date-fns/distance_in_words_to_now\";\nimport FirebaseContext from \"../../firebase/context\";\n\nfunction LinkItem({ link, index, showCount, history }) {\n  const { firebase, user } = React.useContext(FirebaseContext);\n\n  function handleVote() {\n    if (!user) {\n      history.push(\"/login\");\n    } else {\n      const voteRef = firebase.db.collection(\"links\").doc(link.id);\n      voteRef.get().then(doc => {\n        if (doc.exists) {\n          const previousVotes = doc.data().votes;\n          const vote = { votedBy: { id: user.uid, name: user.displayName } };\n          const updatedVotes = [...previousVotes, vote];\n          const voteCount = updatedVotes.length;\n          voteRef.update({ votes: updatedVotes, voteCount });\n        }\n      });\n    }\n  }\n\n  function handleDeleteLink() {\n    const linkRef = firebase.db.collection(\"links\").doc(link.id);\n    linkRef\n      .delete()\n      .then(() => {\n        console.log(`Document with ID ${link.id} deleted`);\n      })\n      .catch(err => {\n        console.error(\"Error deleting document:\", err);\n      });\n  }\n\n  const postedByAuthUser = user && user.uid === link.postedBy.id;\n\n  return (\n    <div className=\"flex items-start mt2\">\n      <div className=\"flex items-center\">\n        {showCount && <span className=\"gray\">{index}.</span>}\n        <div className=\"vote-button\" onClick={handleVote}>\n          â–²\n        </div>\n      </div>\n      <div className=\"ml1\">\n        <div>\n          <a href={link.url} className=\"black no-underline\">\n            {link.description}\n          </a>{\" \"}\n          <span className=\"link\">({getDomain(link.url)})</span>\n        </div>\n        <div className=\"f6 lh-copy gray\">\n          {link.voteCount} votes by {link.postedBy.name}{\" \"}\n          {distanceInWordsToNow(link.created)}\n          {\" | \"}\n          <Link to={`/link/${link.id}`}>\n            {link.comments.length > 0\n              ? `${link.comments.length} comments`\n              : \"discuss\"}\n          </Link>\n          {postedByAuthUser && (\n            <>\n              {\" | \"}\n              <span className=\"delete-button\" onClick={handleDeleteLink}>\n                delete\n              </span>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default withRouter(LinkItem);\n"]},"metadata":{},"sourceType":"module"}